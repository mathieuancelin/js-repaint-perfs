/*
Mag.JS v0.26.91
http://github.com/magnumjs/mag.js
(c) Michael Glazer
License: MIT
*/
(function(b,c){'use strict';function g(P,Q){if(u[P]&&!Q)return u[P];var R=mag.doc.getElementById(P);return R&&(u[P]=R),u[P]}var h='KEY',j=['#'+h,'.'+h,h],l=function(P,Q){var R;for(var S in j){var T=j[S].replace(h,Q);if(R=P.querySelector(T),R)break}return R},n=function(P){var Q=mag.utils.items.getItemVal(P),R=mag.getNode(Q);return R},q=function(P){if('string'==typeof P){var Q=n(~mag.mod.runningViewInstance||mag.utils.runningEventInstance),R=l(Q||mag.doc,P);if(R)return R}return P},r=function(P,Q){var U,R=[],S=P.cloneNode(1),T=[];return function(V){var W=P;if(V){var X=V.key;X&&!R[X]?W=R[X]=S.cloneNode(1):X&&R[X]&&(W=R[X])}if(!U||!V||U!=JSON.stringify(V)){U=JSON.stringify(V);var Y;Y=U in T?T[U]:T[U]=Q(V),mag.fill.run(W,Y)}return W}};b.mag=function(P,Q,R){return P=q(P),Q=q(Q),mag.utils.isHTMLEle(Q)&&mag.utils.isHTMLEle(P)?void(Q[mag.MAGNUM]||mag.fill.run(Q,P)):'function'==typeof Q&&mag.utils.isHTMLEle(P)?r(P,Q):H(-1,g(mag._isNode(P)),Q,R||{})},mag.MAGNUM='__magnum__',mag.doc=c;var t={values:[],attributes:[],elementMatcher:[]},u=[],v=0;mag._isNode=function(P){return mag.utils.isHTMLEle(P)&&(!P.id&&(P.id=++v),u[P.id]=P,P=P.id),P};var w=function(P,Q){var R,S=Q?P+'-'+Q:P;return R=mag.utils.items.isItem(S)?mag.utils.items.getItem(S):mag.utils.getItemInstanceId(S),R};mag.module=function(P,Q,R){R=R||{},P=mag._isNode(P);var S=w(P,R.key),T=x(R,S,Q,P);return T?H(S,T,Q,mag.utils.copy(R)):void 0};var x=function(P,Q,R,S){P.retain||mag.mod.clear(Q),mag.mod.submodule(S,Q,R,P);var T=g(S);if(I(Q,S),!N(Q,T))return mag.redraw(T,Q,1).then(function(){O(Q,T)}),T},y=function(P,Q){return 0>Q||Q!=mag.utils.items.getItem(P)?P==mag.mod.getId(Q):!0},z=[];mag.begin=function(P){'undefined'==typeof z[P]?z[P]=1:z[P]++},mag.end=function(P){if(1<z[P])z[P]--;else{z[P]=0;var Q=mag.utils.items.getItemVal(P);mag.redraw(g(Q),P)}},mag.redraw=function(P,Q,R){if(!z[Q]){if(!P||'undefined'==typeof Q)throw Error('Mag.JS - Id or node invalid: '+mag.utils.items.getItemVal(Q));if(!y(P.id,Q))return{then:()=>{}};if(R&&mag.fill.configs.splice(0,mag.fill.configs.length),R&&mag.mod.clear(Q),mag.mod.runningViewInstance==Q)throw Error('Mag.JS - recursive call: '+Q);var S=J(P,Q,R);return mag.utils.scheduleFlush(S)}},mag.hookin=function(P,Q,R){t[P].push({context:{},handler:R,key:Q})},mag.hook=function(P,Q,R){for(var S=0,T=t[P].length;S<T;S++)mag.utils.callHook(t,Q,P,S,R)};var A={},B=[],C=[],D=function(P,Q,R){var S=mag.getNode(mag.mod.getId(P)),T=function(){mag.utils.callLCEvent('onunload',mag.mod.getState(P),S,P)||(mag.clear(P),M(P,S),Q[P]&&(Q[P].length=0),R&&(mag.fill.removeNode(S),mag.mod.remove(P)))};mag.mod.getState(P).onbeforeunload?mag.utils.callLCEvent('onbeforeunload',mag.mod.getState(P),S,P,0,function(){T()}):T()},E=function(P,Q){C[P]=C[P]||[];var R=C[P].push(Q);return mag.utils.onLCEvent('didupdate',P,function(S,T){var U=mag.utils.merge(mag.utils.copy(T),mag.utils.copy(S));if(JSON.stringify(U)!==JSON.stringify(B[P])){for(var V of C[P])V(S,T,g(mag.mod.getId(P)),B[P]);B[P]=U}}),function(){return C[P].splice(R-1,1)}},F=[],G=function(P,Q,R,S,T){var U=mag.utils.items.getItem(Q);(O(U,P),!(mag.mod.exists(U)&&mag.utils.callLCEvent('willgetprops',mag.mod.getState(U),P,U,0,R)))&&(mag.mod.submodule(P.id,U,S,R),I(U,P.id),N(U,P)||mag.redraw(P,U,T).then(function(){O(U,P)}))},H=function(P,Q,R,S){F[P]=F[P]||[];var T=function(U,V,W,X,Y){'object'==typeof Y&&(X=mag.utils.merge(mag.utils.copy(X),Y),Y=0);var Z=V.id+(X.key?'.'+X.key:'')+'.'+(Y||0);!A[Z]||X.key||~T._id||(Z+=++v);var $=A[Z]=A[Z]||V.cloneNode(1);if($.id=Z,mag.utils.items.isItem(Z))return G($,Z,X,W,1),$;var _=mag.utils.getItemInstanceId($.id);return 0>U?U=T._id=_:F[U].push({instanceId:_,subscribe:E.bind({},_)}),G($,Z,X,W,1),$}.bind({},P,Q,R,S);return T._id=P,T.clones=function(){return F[T._id]},T.destroy=function(U){D(T._id,T.clones,U)},T.getId=function(){return T._id},T.draw=function(U){return mag.redraw(Q,T._id,U)},T.getState=function(){return mag.mod.getState(T._id)},T.getProps=function(){return mag.mod.getProps(T._id)},T.subscribe=function(U){return E(T._id,U)},T},I=function(P,Q){var R=function(S,T){g(T)?mag.redraw(g(T),S):mag.utils.items.isItem(T)&&mag.clear(S)}.bind({},P,Q);mag.mod.setFrameId(P,R)};mag.clear=function(P){mag.utils.items.removeItem(P),mag.mod.clear(P),mag.fill.clearCache(mag.mod.getId(P))};var J=function(P,Q,R){return function(S,T,U){if(g(S.id,1),y(S.id,T)&&S){var V=mag.mod.getState(T);return mag.utils.callLCEvent('isupdate',V,S,T)?void 0:mag.mod.iscached(T)&&!U?0:void(mag.utils.callLCEvent('willupdate',V,S,T)||(mag.mod.callView(S,T),mag.fill.setId(S.id),mag.fill.run(S,V),K(S.id,mag.fill.configs),mag.utils.callLCEvent('didupdate',V,S,T),!U&&mag.mod.iscached(T)))}}.bind({},P,Q,R)},K=function(P,Q){for(var R in Q)R.startsWith('id("'+P+'")/')&&Q[R]()},L=function(P){var R=[];for(var S in mag.fill.cached)-1<S.indexOf('id("'+P+'")/')&&-1<S.indexOf('-config')&&mag.fill.cached[S].configContext&&R.push({path:S.split('-config')[0],controller:mag.fill.cached[S].configContext,handler:mag.fill.cached[S].configContext.onunload});return R},M=function(P,Q){for(var T,R=L(Q.id,P),S=0,U=R;T=U&&U[S];S++)T.controller.onunload&&(T.handler.call(T.controller,Q,T.path),T.controller.onunload=0)},N=function(P,Q){return mag.utils.callLCEvent('willload',mag.mod.getState(P),Q,P,1)},O=function(P,Q){var R=mag.utils.items.getItemVal(P);if(g(R))return mag.utils.callLCEvent('didload',mag.mod.getState(P),Q,P,1)};mag.getNode=g})(window||global||this,document),function(b){'use strict';function c(t,u){var v=t.name;if('undefined'==typeof t.object[t.name]&&'_'!==v[0]){var w=b.fill.find(u,v),x='$'===v[0],y=[];return w.length?(w.forEach(function(z){var A;if(!(z&&z.type&&!~['submit','button'].indexOf(z.type)))'undefined'==typeof t.oldValue&&'undefined'==typeof t.object[t.name]&&z&&!~['submit','button'].indexOf(z.type)&&1==z.childNodes.length&&z.childNodes[0].textContent.trim()&&(A={_text:z.childNodes[0].textContent.trim()});else if(z.value&&0<z.value.length)if('checkbox'!=z.type&&'radio'!=z.type)A={_value:z.value};else if(z.checked&&(A={},A._checked=!0),!x){var B=u.querySelectorAll('[name='+z.name+']');if(B.length)for(var C of B)C.checked&&(A?A._value=C.value:A={_value:C.value})}else A?A._value=z.value:A={_value:z.value};A?y.push(A):z&&!z.hasChildNodes()&&y.push(h)}),0===y.length?void 0:x?y:y[0]&&'undefined'!=typeof y[0]._value?y[0]._value:y[0]&&y[0]._text?y[0]._text:y[0]):h}}function f(t,u){var w;return l.setProps(u,b.proxy(l.getProps(u),r.bind({},'props',u),'prop')),w=new t(b.proxy({},r.bind({},'state',u))),w}var g=[],h=b.MAGNUM,l={runningViewInstance:-1,innerMods:[],cache:[]};l.getState=function(t){return g[t][1]},l.setState=function(t,u){g[t][1]=u},l.getView=function(t){return g[t][0]},l.getProps=function(t){return g[t][2]},l.setProps=function(t,u){return g[t][2]=u},l.remove=function(t){g.splice(t,1)},l.getId=function(t){return g[t]&&g[t][3]},l.exists=function(t){return'undefined'!=typeof g[t]},l.setFrameId=function(t,u){g[t][4]=u},l.getFrameId=function(t){return g[t][4]},l.submodule=function(t,u,v,w){if(g[u])return w.key&&w.key===l.getProps(u).key?l.setProps(u,b.utils.copy(b.utils.merge(l.getProps(u),w))):l.setProps(u,w),g[u];g[u]=[0,0,0,0,0],l.setProps(u,w);var y=function(A,B,C){v.view&&v.view.call(v,B,l.getProps(A),C)}.bind({},u),z={controller:function(A){return(v.controller||function(){}).call(A,l.getProps(u))||A},view:y};return g[u][0]=z.view,g[u][3]=t,g[u][1]=f(z.controller,u,t),g[u]};var n=[],q=function(t,u){var v=t,w=u.split('/');for(var x of w)if(x){var y=b.fill.find(v,x);y.length&&(v=y[0])}return v},r=function(t,u,v){if('get'==v.type&&'props'!=t&&!~b.fill.ignorekeys.indexOf(v.name.toString())&&'undefined'==typeof v.oldValue){var w=b.doc.getElementById(l.getId(u));if(v.path&&'/'==v.path[0])var x=q(w,v.path);var y=c(v,x?x:w);if('undefined'!=typeof y&&'object'==typeof y&&v.object&&b.utils.merge(y,v.object[v.name]),'undefined'!=typeof y)return l.cached[u]=0,y}else'set'==v.type&&'props'!=t&&v.object[v.name]&&v.object[v.name].draw&&'function'==typeof v.object[v.name].draw&&(l.innerMods[l.getId(u)]=[v.name,v.object[v.name]]);var z=l.getFrameId(u);'function'==typeof z&&'set'==v.type&&(cancelAnimationFrame(n[u]),n[u]=requestAnimationFrame(z))};l.iscached=function(t){var u=JSON.stringify(b.utils.merge(b.utils.copy(l.getProps(t)),l.getState(t)));return t in l.cache&&l.cache[t]==u||void(l.cache[t]=u)},l.remove=function(t){g[t]&&(g[t]=0)},l.clear=function(t){~t&&l.cache[t]&&l.cache.splice(t,1)},l.cached=[],l.callView=function(t,u){l.runningViewInstance=u,l.cached[u]||(b.props.attachToArgs(u,l.getState(u),t),l.cached[u]=1);try{l.getView(u)(l.getState(u),t)}finally{l.runningViewInstance=-1}},b.mod=l}(mag),function(b){'use strict';function f(v,w,x,y){var z=[];for(var A in v){var B=v[A];h(B)&&(z.push(B),g(B,w,x,y))}return!!z.length&&(1==z.length?z[0]:z)}function g(v,w,x,y){if(v[n]=v[n]||{},!v[n].eventOnFocus){var z=function(A,B,C){var E=~['radio','checkbox'].indexOf(v.type);this[n].dirty||(this[n].dirty=1),E&&('_checked'in B||'_value'in B?B._checked=this.checked:this.checked&&(B[C]=this.value)),b.redraw(A,b.utils.items.getItem(A.id))}.bind(v,y,w,x);v.addEventListener('click',z,!1),v.addEventListener('input',z,!1),v.addEventListener('focus',z,!1),v[n].eventOnFocus=1}}function h(v){return v&&~['INPUT','SELECT','TEXTAREA'].indexOf(v.tagName)}function j(v){for(var w in v)if(h(v[w]))return v[w];return!1}var l={},n=b.MAGNUM,q=function(v,w){for(var x=1;x<v.length;x++){var y=v[x],z=v[x+1],A=b.fill.find(Array.isArray(w)?w[0]:w,y);z&&!isNaN(+z)?w=A[z]:A&&A.length&&z?w=b.fill.find(A[0],z):A&&A.length&&(w=A)}return Array.isArray(w)?w[0]:w},r=function(v,w,x,y){var A,z=x.toString().split('.');if(3<=z.length)y=q(z,y),A=b.fill.find(y,w);else{var B=parseInt(z.pop()),C=isNaN(B)?0:B;A=b.fill.find(y[C]?y[C]:y,w)}return f(A,v,w,y)},t=function(v,w,x,y){var z=x[w];~['_value','_checked'].indexOf(w)&&(w=v.split('.').pop());var A=b.fill.find(y,w),B=j(A);if('function'!=typeof z&&B){var C=r.bind({},x,w,v,y);C(),Object.defineProperty(x,w,{configurable:!0,get:function(){var D=C();return D&&'undefined'!==D.value&&D[n]&&D[n].dirty&&D.value!==z?(z=D.value,b.redraw(y,v,1),D.value):z},set:function(D){var E=C();E&&'undefined'!==E.value&&E.value!==D&&D!==z&&(E.value=D,z=D)}})}},u=function(v,w,x){for(var y in w)if(w.hasOwnProperty(y)){var z=w[y];'object'!=typeof z||b.utils.isHTMLEle(z)?t.bind({},v,y,w,x)():u(v+'.'+y,z,x)}};l.attachToArgs=u,b.props=l}(mag),function(b){'use strict';var c={isObject:function(l){return'Object]'==Object.prototype.toString.call(l).substr(-7)},isHTMLEle:function(l){return l&&l.nodeType&&1==l.nodeType},callHook:function(l,n,q,r,t,u){l[q][r].key==n&&(u={v:t.value,k:t.key},t.change=!1,l[q][r].handler.call(l[q][r].context,t),{v:t.value,k:t.key}!==u&&(t.change=!0))}},f=!1,g=[];c.scheduleFlush=function(l){return new Promise(function(n){g.push(l),f?n():(f=!0,requestAnimationFrame(function(){for(var q;q=g.shift();)q();f=!1,n()}))})};var h=[];c.onLCEvent=function(l,n,q){var r=l+'-'+n;h[r]=h[r]||[];var t=h[r].push(q);return function(){return h[r].splice(t-1,1)}},c.callLCEvent=function(l,n,q,r,t,u){var v;c.runningEventInstance=r,n&&n[l]&&(v=n[l].call(n,q,b.mod.getProps(r),r,u),t&&(n[l]=0));var w=l+'-'+r;if(h[w]){for(var x of h[w])x(b.mod.getState(r),b.mod.getProps(r));t&&(h[l]=0)}return(c.runningEventInstance=-1,!1===v)||void 0},c.copy=function(l){return Object.assign({},l)},c.merge=function(){return Object.assign.apply({},arguments)};var j={i:[],isItem:function(l){return~j.i.indexOf(l)},setItem:function(l){j.i[j.i.length]=l},getItem:function(l){return j.i.indexOf(l)},getItemVal:function(l){return j.i[l]},removeItem:function(l){j.i.splice(j.i.indexOf(l),1)}};c.items=j,c.getItemInstanceIdAll=function(){return j.i},c.getItemInstanceId=function(l){return j.isItem(l)?j.getItem(l):(j.setItem(l),j.getItem(l))},b.utils=c}(mag),function(b,c,f){'use strict';function g($){return Array.isArray($)}function h($,_){return $[P]=$[P]||{},(!$[P].uid||_)&&($[P].uid=++W),$[P].uid}function j($,_){var aa=h($,_);return T[aa]?T[aa]:T[aa]=q($)}function l($,_,aa){var ba=h($,aa);return U[N.id]=U[N.id]||[],U[N.id][ba]&&U[N.id][ba]==_?1:void(U[N.id][ba]=_)}function n($){return $.id?$:$.parentNode?n($.parentNode):void 0}function q($){var _='',aa=n($),ba=$.parentNode&&[].indexOf.call($.parentNode.children,$);return aa&&(_+='id("'+aa.id+'")'),_+='/'+$.tagName+'['+(ba+1)+']',_}function r($){if($.id&&N.id===$.id)return'id("'+$.id+'")';if($===b.doc.body)return $.tagName;var _=0;if($.parentNode)for(var ca,aa=$.parentNode.childNodes,ba=0;ba<aa.length;ba++){if(ca=aa[ba],ca===$)return r($.parentNode)+($.tagName?'/'+$.tagName+'['+(_+1)+']':'');1===ca.nodeType&&ca.tagName===$.tagName&&_++}}function t($){var _=r($);$&&O[_+'-config']&&O[_+'-config'].configContext&&typeof O[_+'-config'].configContext.onunload==='function'&&(O[_+'-config'].configContext.onunload(O[_+'-config'].configContext,$,_),delete O[_+'-config'],delete N.configs[_]),$.parentNode&&$.parentNode.removeChild($),b.mod.cached[b.utils.items.getItem(N.id)]=0}function u($){var _=$&&parseInt($.split('[').pop().slice(0,-1));return _?parseInt(_)-1:0}function v($){return $&&~$.indexOf('id(')&&$.split('id("')[1].split('")')[0]}function w($){if($&&$[P]&&$[P].isChildOfArray)return $;return $.parentNode?w($.parentNode):void 0}function x($,_,aa){if(!l($,_.outerHTML,aa)&&(!_.id&&!$.childNodes[0]||_.id&&!b.doc.getElementById(_.id)||$.firstChild&&!$.firstChild.isEqualNode(_))){var ba=b.utils.items.getItem(_.id);if(~ba){var ca=b.utils.items.getItem(N.id),da=$.cloneNode(1);da[P]={childof:ca},b.mod.getProps(ba).children=da}for(;$.lastChild;)$.removeChild($.lastChild);if(_[P]&&_[P].childof!==f){$.innerHTML=_.innerHTML;var ea=b.utils.items.getItem(N.id);X.push(ea+','+_[P].childof),b.utils.merge(b.mod.getState(ea),b.mod.getState(_[P].childof))}else $.appendChild(_)}}function y($,_){var aa;for(var ba in _){var ca=_[ba];ca===f?ca='':null===ca&&-1===['onunload'].indexOf(ba)?($[P].detached=$[P].detached||[],$[P].detached[ba]=1,C($,ba)):$[P].detached&&$[P].detached[ba]&&(B($,ba),$[P].detached[ba]=0),'_'===ba[0]&&'_'!==ba[1]&&(aa=aa||{},aa[ba.substr(1)]=ca)}return aa}function z($,_,aa){var ba;for(var ca in _){var da=_[ca];if(!~N.ignorekeys.indexOf(ca)&&'_'!==ca[0]){ba=I($,ca);var ea={key:ca,value:da,node:$};b.hook('values','*',ea),ea.change&&(da=ea.value),g(da)&&(ba=I($,'$'+ca)),N.run(ba,da,aa+'/'+ca)}}}function A($,_,aa){var ba,fa=u(aa);return _&&b.utils.isHTMLEle(_)?void x($,_):'function'==typeof _?Y(_,$,fa,aa):'object'==typeof _?void(b.mod.innerMods[N.id]&&_[b.mod.innerMods[N.id][0]]&&!_[b.mod.innerMods[N.id][0]].draw&&b.mod.innerMods[N.id][1].destroy(),ba=y($,_),ba&&F($,ba,aa),z($,_,aa)):A($,{_text:_},aa)}function B($,_){var aa=I($,_);aa.forEach(function(ba){var ca=h(ba);if(ca in Z){for(var da in Z[ca])ba.appendChild(Z[ca][da]);delete Z[ca]}})}function C($,_){var aa=0,ba=1,ca=function(fa){if(++aa==ba)for(;fa.lastChild;)t(fa.lastChild)},da=function(fa,ga){var ha;fa.id&&b.utils.items.isItem(fa.id)&&(ha=b.utils.items.getItem(fa.id)),ha&&b.mod.getState(ha).onbeforeunload?(ba++,b.utils.callLCEvent('onbeforeunload',b.mod.getState(ha),fa,ha,0,function(){ha&&b.utils.callLCEvent('onunload',b.mod.getState(ha),fa,ha),ga()})):(ha&&b.utils.callLCEvent('onunload',b.mod.getState(ha),fa,ha),ga())},ea=I($,_);ea.forEach(function(fa){var ga=h(fa);fa.children.length&&(Z[ga]=D(fa.children));for(var ia in Z[ga]){var ja=Z[ga][ia];da(ja,function(){ca(fa)})}ca(fa)})}function D($){var _;if(null==$.length&&($=[$]),!g($)){_=[];for(var aa=0;aa<$.length;aa+=1)$[aa]&&_.push($[aa]);$=_}return $}function E($,_,aa){var ba=function(ca,da,ea){var fa=w(da),ga=fa&&r(fa),ha=u(ga),ia=j(da,1),ja=u(ia),ka={path:ga,data:((fa||{})[P]||[]).dataPass,node:fa,index:ha},la=v(ia),ma=b.doc.getElementById(la),na=ca.call(da,ea,ja,da,ka);if(la&&ma){var oa=function(){b.redraw(ma,b.utils.items.getItem(la),1)};na&&na.then?na.then(function(pa){return oa(),pa}):oa()}return na}.bind({},_[aa],$);return ba}function F($,_,aa){var ba=u(aa);for(var ca in O[h($)]=O[h($)]||[],_)if('text'!==ca&&'html'!==ca)if(0==ca.indexOf('on'))$[ca.toLowerCase()]=E($,_,ca);else{if('config'==ca){var aa=r($),ba=u(aa),da=!0;O[aa+'-config']?da=!1:O[aa+'-config']={};var ea=O[aa+'-config'].configContext=O[aa+'-config'].configContext||{},fa=function(ja,ka){return function(){return ja.apply(ja,ka)}};c[aa]=fa(_[ca],[$,da,ea,ba]);continue}var ga={key:ca,value:_[ca],node:$};if(b.hook('attributes',ca,ga),ga.change&&(ca=ga.key,_[ca]=ga.value),O[h($)]&&O[h($)][ca]==_[ca])continue;null===_[ca]?$.removeAttribute(ca):ca in $?'style'==ca?$[ca].cssText=_[ca]:$[ca]=_[ca]:$.setAttribute(ca,_[ca]+''),O[h($)][ca]=_[ca]}G($,_.text),H($,_.html)}function G($,_){if($&&null!=_&&!l($,_)){var aa=_+'';if('INPUT'!==$.nodeName)'SELECT'!==$.nodeName&&($.firstChild?$.firstChild.textContent=aa:$.appendChild($.ownerDocument.createTextNode(aa)));else if(!~['radio','checkbox'].indexOf($.type))aa!=$.value&&($.value=aa);else if($.name){var ba=b.getNode(N.id).querySelectorAll('[name='+$.name+']');if(1<ba.length)for(var ca of ba)if(ca.value==aa){ca.checked=!0;break}}'SELECT'===$.nodeName&&aa&&($.value=aa)}}function H($,_){!$||null==_||l($,_)||($.innerHTML=b.utils.isHTMLEle(_)?_.innerHTML:_)}function I($,_,aa){var ba=L($),ca=[],da=_,ea='$'===_[0];'$'===da[0]&&(da=da.substr(1));for(var fa=0;fa<ba.length;fa+=1)M(ba[fa],da)&&ca.push(ba[fa]);if(!ca.length||ea)for(var fa=0;fa<ba.length&&(ca=ca.concat(I(ba[fa],_,!0)),!ca.length||ea);fa++);if(!aa&&!ca.length){var ga={key:_,value:ca,node:$};b.hook('elementMatcher',_,ga),ga.change&&(ca=ga.value)}return ca}function J($,_){return~X.indexOf($+','+_)}function K($){return $.id==N.id||J(b.utils.items.getItem(N.id),b.utils.items.getItem($.id))||!b.utils.items.isItem($.id)}function L($){var _=[];if($){var aa=$.childNodes;if(aa)for(var ba=0;ba<aa.length;ba+=1)1===aa[ba].nodeType&&K(aa[ba])&&_.push(aa[ba])}return _}function M($,_){var aa=' '+$.className+' ';return $.id===_||~aa.indexOf(' '+_+' ')||$.name===_||$.nodeName.toLowerCase()===_.toLowerCase()||$.getAttribute('data-bind')===_}var N={cached:[],ignorekeys:['toString','draw','then','hasOwnProperty','willgetprops','onbeforeunload','Symbol(Symbol.toStringTag)','nodeType','toJSON','onunload','willupdate','didupdate','didload','willload','isupdate']},O=N.cached,P=b.MAGNUM,R='undefined',S='_key',T=[],U=[],V={},W=0;N.run=function($,_,aa){var ba,ca;if($){null==_&&(_={_text:''});var da=D($);if(ca=g(_),ca){if(V[aa]&&0===da.length&&(V[aa].parent.insertAdjacentHTML('beforeend',V[aa].node),da=D(V[aa].parent.children)),!da.length)return;var ea=da[0].parentNode;for(V[aa]||(V[aa]={node:da[0].cloneNode(1).outerHTML,parent:ea});da.length<_.length;)V[aa]?(ea.insertAdjacentHTML('beforeend',V[aa].node),ba=ea.lastChild):ba=da[0].cloneNode(1),da.push(ba),ea&&ea.appendChild(ba);var fa=_.map(function(ka){return ka&&ka[S]});if((da.length==_.length||-1!==fa.indexOf(f))&&(_=_.map(function(ka,la){if('object'==typeof ka){if(da[la][P]=da[la][P]||{},da[la][P].__key&&typeof ka[S]==R)return ka[S]=da[la][P].__key,ka;typeof ka[S]==R&&(ka[S]=P+la),da[la][P].__key=ka[S]}return ka})),da.length>_.length)if(0===_.length||'object'!=typeof _[0])for(;da.length>_.length;)ba=da.pop(),ea=ba.parentNode,ea&&t(ba);else{var ga=[],ha=_.map(function(ka){return ka[S]});da=da.filter(function(ka){var ma;return(typeof ka[P]==R?ma=1:(!~ha.indexOf(ka[P].__key)||~ga.indexOf(ka[P].__key))&&(ga.push(ka[P].__key),ma=1),ma)?(t(ka),!1):(ga.push(ka[P].__key),!0)})}}for(var ia=0;ia<da.length;ia++)if(ca)da[ia]&&N.run(da[ia],_[ia]);else{var ja=j(da[ia]);_&&'object'==typeof _&&(da[ia][P]=da[ia][P]||{},_[S]!==f&&(da[ia][P].isChildOfArray=!0,da[ia][P].dataPass=_[P]),da[ia][P].xpath=ja),A(da[ia],_,ja)}}};var X=[],Y=function($,_,aa,ba){var ca=w(_.parentNode),da=ca&&ca.getAttribute('key');ca&&da&&(aa=+da.split(P)[1]);var ea=$(aa);if(ea&&b.utils.isHTMLEle(ea))return x(_,ea),_[P]=_[P]||{},_[P].isChildOfArray=!0,_[P].dataPass={index:aa},void($.draw&&$.draw());var fa=/<[a-z][\s\S]*>/i.test(ea)?'_html':'_text',ga={};return ga[fa]=ea,A(_,ga,ba)},Z=[];N.removeNode=t,N.configs=c,N.find=I,N.setId=function($){N.id=$},N.clearCache=function($){U[$]&&delete U[$]},b.fill=N}(mag,[]),function(b){function f(h,j,l,n){function q(t){return r.has(t)}var r=new WeakSet;return new Proxy(h,{get:function(t,u,v){var w=t[u];if('symbol'==typeof u)return w;if('object'!=typeof w||'symbol'==typeof w||null===w||'function'==typeof w||Array.isArray(w)||!b.utils.isObject(w)||w.then||w.draw)u in t||~b.fill.ignorekeys.indexOf(u.toString())||l||'_'==u[0]||(w=b.proxy({},j,l,n+g+u));else if(!q(w))return r.add(w),b.proxy(w,j,l,n+g+u);var x=j({type:'get',object:t,name:u,path:n,oldValue:Reflect.get(t,u,v)});return'undefined'!=typeof x&&(w=x==b.MAGNUM?void 0:x),w},deleteProperty:function(t,u){return j({type:'delete',name:u,object:t,oldValue:Reflect.get(t,u)}),Reflect.deleteProperty(t,u)},set:function(t,u,v,w){var x=Reflect.get(t,u,w);return x===v&&'length'!==u||(j({type:'set',name:u,object:t,oldValue:x}),Reflect.set(t,u,v,w))}})}var g='/';b.proxy=function(h,j,l,n){for(var q in h){var r=typeof h[q];Array.isArray(h[q])&&101>h[q].length?h[q]=f(h[q],j):'object'==r&&null!==h[q]&&'symbol'!=typeof q&&'symbol'!=r&&'function'!=r&&b.utils.isObject(h[q])&&(h[q]=b.proxy(h[q],j,l,n+g+q))}return f(h,j,l,n||g)}}(mag,window||global||this);
